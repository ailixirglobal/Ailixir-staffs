{% extends "base.html" %}
{% load static %}

{% block content %}

<div class="nk-block-head nk-block-head-sm">
    <div class="nk-block-between">
        <div class="nk-block-head-content">
            <h3 class="nk-block-title">Notifications</h3>
            <p class="text-soft">View all messages sent to you.</p>
        </div>
    </div>
</div>

<div class="nk-block">

    {% if notifications %}
        <div class="card card-bordered">
            <div class="card-inner">

                <ul class="nk-activity">

                    {% for notif in notifications %}
                    <a href="{% url 'notifications:view' notif.id %}" class="text-reset" style="text-decoration:none;">
                        <li class="nk-activity-item {% if not notif.read %}bg-light{% endif %} p-2 rounded">

                            <div class="nk-activity-media bg-primary-dim">
                                <em class="icon ni ni-bell"></em>
                            </div>

                            <div class="nk-activity-data" style="width:100%">

                                <!-- Title -->
                                <div class="label font-weight-bold">
                                    {{ notif.notification.title }}
                                    {% if not notif.read %}
                                        <span class="badge badge-dot badge-primary"></span>
                                    {% endif %}
                                </div>

                                <!-- Message -->
                                <div class="sub-text text-soft">
                                    {{ notif.notification.message|truncatechars:120 }}
                                </div>

                                <!-- Time -->
                                <div class="time mt-1 text-muted small">
                                    {{ notif.notification.created_at|timesince }} ago
                                </div>

                            </div>

                            <!-- Action Button -->
                            <div class="nk-activity-action ml-auto" style="min-width:110px;">
                                {% if not notif.read %}
                                <a href="{% url 'notifications:read' notif.id %}" 
                                   class="btn btn-sm btn-primary"
                                   onclick="event.stopPropagation();" 
                                   >
                                    Mark as Read
                                </a>
                                {% endif %}
                            </div>

                        </li>
                    </a>
                    {% endfor %}

                </ul>

            </div>
        </div>

    {% else %}
        <div class="card card-bordered">
            <div class="card-inner text-center text-soft p-5">
                <em class="icon ni ni-bell-off" style="font-size:40px;"></em>
                <h5 class="mt-2">No Notifications</h5>
                <p>You currently have no messages.</p>
            </div>
        </div>
    {% endif %}

</div>

{% endblock %}